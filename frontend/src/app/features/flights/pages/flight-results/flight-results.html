<section class="flight-results">
    <div class="results-header">
        <button mat-icon-button (click)="navigateToFlights()" aria-label="Back to search">
            <mat-icon>arrow_back</mat-icon>
        </button>

        <h1 class="page-title">Flight Results</h1>
    </div>

    @if (loading$ | async) {
    <div class="flex-center mt-100">
        <mat-spinner diameter="50"></mat-spinner>
    </div>
    }


    @if (results$ | async; as results) {

    @if (!results.outboundFlights.length) {
    <div class="flex-center mt-100">
        No flights found
    </div>
    }

    @if (results.outboundFlights.length) {
    <h3 class="section-title">Outbound Flights</h3>
    }

    @for (flight of results.outboundFlights; track flight._id) {
    <mat-card class="flight-card">

        <div class="flight-header">
            <strong>{{ flight.airline }}</strong>
            <span>{{ flight.flightNumber }}</span>
        </div>

        <div class="flight-body">
            <div>{{ flight.origin }} → {{ flight.destination }}</div>
            <div>
                {{ flight.departureTime | date:'shortTime' }} –
                {{ flight.arrivalTime | date:'shortTime' }}
            </div>
            <div>
                Duration: {{ flight.durationMinutes | duration }}
            </div>
        </div>

        <div class="flight-footer">
            <strong>₹{{ flight.price }}</strong>

            <button mat-flat-button color="primary" (click)="selectFlight(flight)">
                Book
            </button>
        </div>

    </mat-card>
    }

    @if (results.returnFlights?.length) {

    <h3 class="section-title mt-40">Return Flights</h3>

    @for (flight of results.returnFlights; track flight._id) {
    <mat-card class="flight-card">

        <div class="flight-header">
            <strong>{{ flight.airline }}</strong>
            <span>{{ flight.flightNumber }}</span>
        </div>

        <div class="flight-body">
            <div>{{ flight.origin }} → {{ flight.destination }}</div>
            <div>
                {{ flight.departureTime | date:'shortTime' }} –
                {{ flight.arrivalTime | date:'shortTime' }}
            </div>
            <div>
                Duration: {{ flight.durationMinutes | duration }}
            </div>
        </div>

        <div class="flight-footer">
            <strong>₹{{ flight.price }}</strong>

            <button mat-flat-button color="primary" (click)="selectFlight(flight)">
                Book
            </button>
        </div>

    </mat-card>
    }
    }
    }

</section>